---
layout: post
title: OpenTTD如何修改车辆参数2-nfo文件格式
categories:
- 教程
- 游戏
tags:
- NewGRF
- openttd
- 补丁
- 车辆修改
- 运输大亨
published: true
comments: true
---
<p><span style="font-weight: 600; color: #555555;"><a class="row-title" style="color: #0074a2;" title="OpenTTD如何修改车辆参数1-工具" href="http://www.itcsl.cn/2014/05/27/openttd%e5%a6%82%e4%bd%95%e4%bf%ae%e6%94%b9%e8%bd%a6%e8%be%86%e5%8f%82%e6%95%b0-1/">OpenTTD如何修改车辆参数1-工具</a></span></p>

<p><span style="font-weight: 600; color: #555555;"><a class="row-title" style="color: #0074a2;" title="OpenTTD如何修改车辆参数2-nfo文件格式" href="http://www.itcsl.cn/2014/05/30/openttd%e5%a6%82%e4%bd%95%e4%bf%ae%e6%94%b9%e8%bd%a6%e8%be%86%e5%8f%82%e6%95%b02-nfo%e6%96%87%e4%bb%b6%e6%a0%bc%e5%bc%8f/">OpenTTD如何修改车辆参数2-nfo文件格式</a></span></p>

<p><span style="font-weight: 600; color: #555555;"><a class="row-title" style="color: #0074a2;" title="OpenTTD如何修改车辆参数3-车辆ID列表" href="http://www.itcsl.cn/2014/05/30/openttd%e5%a6%82%e4%bd%95%e4%bf%ae%e6%94%b9%e8%bd%a6%e8%be%86%e5%8f%82%e6%95%b03-%e8%bd%a6%e8%be%86id%e5%88%97%e8%a1%a8/">OpenTTD如何修改车辆参数3-车辆ID列表</a></span></p>

<p><span style="font-weight: 600; color: #555555;"><a class="row-title" style="color: #0074a2;" title="OpenTTD如何修改车辆参数4-车辆属性列表" href="http://www.itcsl.cn/2014/05/30/openttd%e5%a6%82%e4%bd%95%e4%bf%ae%e6%94%b9%e8%bd%a6%e8%be%86%e5%8f%82%e6%95%b0/">OpenTTD如何修改车辆参数4-车辆属性列表</a></span></p>

<p>&nbsp;</p>

<p>我们来分析一下“NewTrain.nfo”文件的格式：
<blockquote>// Automatically generated by GRFCODEC. Do not modify!</blockquote></p>

<p>// (Info version 32)<br />
// Escapes: 2+ 2- 2&lt; 2&gt; 2u&lt; 2u&gt; 2/ 2% 2u/ 2u% 2* 2&amp; 2| 2^ 2sto = 2s 2rst = 2r 2psto 2ror = 2rot 2cmp 2ucmp 2&lt;&lt; 2u&gt;&gt; 2&gt;&gt;<br />
// Escapes: 71 70 7= 7! 7&lt; 7&gt; 7G 7g 7gG 7GG 7gg 7c 7C<br />
// Escapes: D= = DR D+ = DF D- = DC Du* = DM D* = DnF Du&lt;&lt; = DnC D&lt;&lt; = DO D&amp; D| Du/ D/ Du% D%<br />
// Format: spritenum imagefile depth xpos ypos xsize ysize xrel yrel zoom flags
<span style="color: #333333;">上面像注释一样的部分非常重要，一般不需要修改。接下来的所有行的基本格式都是如下：</span></p>

<p><span style="color: #333333;">【编号】【*】【数据字节数】【16进制数据】</span></p>

<p><span style="color: #333333;">编号是一个从0开始的每行递增的值。</span></p>

<p><span style="color: #333333;">数据字节数的值为“16进制数据部分”的长度，以16进制表示</span>
<blockquote>0 * 4 2F 00 00 00</blockquote>
<span style="color: #333333;">编号为0的行的长度是固定的，数据部分的值为总的编号行的行数，如“2f”表示47行，我测试的时候好像比总行数大也没有什么问题，</span></p>

<p><span style="color: #333333;">该行以下的所有行的【16进制数据】部分具有如下格式。</span></p>

<p><span style="color: #333333;">【16进制数据】=【Action编号】【Action属性】</span></p>

<p><span style="color: #333333;"> </span>
<blockquote>1 * 6 <span style="color: #00ff00;">07</span> 83 01 \7! 00 00</blockquote></p>

<p><span style="color: black;">2 * 71 <span style="color: #00ff00;">08</span> 06 "MG" 01 09 "NewTrainSet" 00 8A "⌐ 2011 Matthias "</span></p>

<p><span style="color: black;">"Gⁿrtler - Licensed under GNU GPL "</span></p>

<p><span style="color: black;">"v2" 00</span>
NewGRF规范定义了很多Actions，每个Action有一个唯一的编号和不同的属性，Action ID见每行的绿色部分。修改车辆属性主要是使用Action 0。大家可以参考<a href="http://newgrf-specs.tt-wiki.net/wiki/Main_Page"><span style="color: #333333;">wiki</span></a>。编号为1、Action ID为07的行可以不用关心，编号为2的行使用了Action 08，该Action用来定义NewGRF的ID、名称与描述。
<blockquote>3 * 8 <span style="color: #00ff00;">00</span> 00 01 01 00 00 00 00<br />
4 * 8 <span style="color: #00ff00;">00</span> 00 01 01 00 09 EF EF<br />
5 * 8 <span style="color: #00ff00;">00</span> 00 01 01 00 0B EF EF<br />
6 * 7 <span style="color: #00ff00;">00</span> 00 01 01 00 04 FF<br />
7 * 7 <span style="color: #00ff00;">00</span> 00 01 01 00 03 FE</blockquote>
我们主要来解释一下修改车辆属性的Action 0，上面编号为3、4、5、6、7的行都是使用Action 0对车辆进行修改。Action 0的数据部分格式如下：
<table>
<tbody>
<tr>
<th>字段名</th>
<th>字段长度</th>
<th>字段描述</th>
</tr>
<tr>
<td>特性id</td>
<td>B</td>
<td>00 表示修改火车<br />
01 表示修改汽车<br />
02 表示修改轮船<br />
03 表示修改飞机</td>
</tr>
<tr>
<td>每个车辆修改的属性个数</td>
<td>B</td>
<td>你希望改变每个车辆的多少个属性</td>
</tr>
<tr>
<td>修改的车辆个数</td>
<td>B</td>
<td>你想改变多少个车辆</td>
</tr>
<tr>
<td>第一个车辆的ID</td>
<td>B*</td>
<td>第一个车辆的id，游戏自带车辆的id参考<a title="OpenTTD如何修改车辆参数3-车辆ID列表" href="http://www.itcsl.cn/2014/05/30/openttd%e5%a6%82%e4%bd%95%e4%bf%ae%e6%94%b9%e8%bd%a6%e8%be%86%e5%8f%82%e6%95%b03-%e8%bd%a6%e8%be%86id%e5%88%97%e8%a1%a8/">车辆id列表</a></td>
</tr>
<tr>
<td>要修改的属性</td>
<td>B</td>
<td>修改的属性id，见<a title="OpenTTD如何修改车辆参数4-车辆属性列表" href="http://www.itcsl.cn/2014/05/30/openttd%e5%a6%82%e4%bd%95%e4%bf%ae%e6%94%b9%e8%bd%a6%e8%be%86%e5%8f%82%e6%95%b0/">车辆属性id参考</a></td>
</tr>
<tr>
<td>属性的值</td>
<td>V</td>
<td>属性值</td>
</tr>
</tbody>
</table>
&nbsp;</p>

<p>我们来分析    <span style="font-style: italic; color: #333333;">4 * 8 </span><span style="color: #00ff00;">00</span><span style="font-style: italic; color: #333333;"> 00 01 01 00 09 EF EF</span><span style="font-style: italic; color: #333333;">   这行，见下表</span>
<table style="height: 300px;" width="961">
<tbody>
<tr>
<th>字段</th>
<th>描述</th>
</tr>
<tr>
<td>4</td>
<td> 行的编号</td>
</tr>
<tr>
<td>8</td>
<td> 数据部分的长度</td>
</tr>
<tr>
<td>00</td>
<td> 使用修改车辆属性的Action，其id为0</td>
</tr>
<tr>
<td>00</td>
<td> 00表示修改火车</td>
</tr>
<tr>
<td>01</td>
<td> 表示希望改变每个车辆的一个属性</td>
</tr>
<tr>
<td>01</td>
<td> 表示希望改变一个车辆</td>
</tr>
<tr>
<td>00</td>
<td>第一个被修改的车辆ID为00，代表车辆“Kirby Paul Tank (Steam)”</td>
</tr>
<tr>
<td>09</td>
<td> 修改车辆的09属性，09属性代表车辆速度，速度属性有2个字节</td>
</tr>
<tr>
<td>EF EF</td>
<td> 车辆的速度</td>
</tr>
</tbody>
</table>
&nbsp;</p>

<p>再来分析 10 * 7 00 03 01 01 26 03 FE 这行<span style="font-style: italic; color: #333333;">，见下表</span>
<table width="961">
<tbody>
<tr>
<th>字段</th>
<th>描述</th>
</tr>
<tr>
<td>10</td>
<td> 行的编号</td>
</tr>
<tr>
<td>7</td>
<td> 数据部分的长度</td>
</tr>
<tr>
<td>00</td>
<td> 使用修改车辆属性的Action，其id为0</td>
</tr>
<tr>
<td>03</td>
<td> 03表示修改飞机</td>
</tr>
<tr>
<td>01</td>
<td> 表示希望改变每个车辆的一个属性</td>
</tr>
<tr>
<td>01</td>
<td> 表示希望改变一个车辆</td>
</tr>
<tr>
<td>26</td>
<td>第一个被修改的车辆ID为26，代表直升机“Tricario Helicopter”</td>
</tr>
<tr>
<td>03</td>
<td> 修改车辆的03属性，03属性代表车辆的寿命</td>
</tr>
<tr>
<td>FE</td>
<td> 车辆的寿命</td>
</tr>
</tbody>
</table>
&nbsp;</p>

<p>再来分析 19 * 7 00 01 01 01 00 08 EF 这行<span style="font-style: italic; color: #333333;">，见下表</span>
<table width="961">
<tbody>
<tr>
<th>字段</th>
<th>描述</th>
</tr>
<tr>
<td>19</td>
<td> 行的编号</td>
</tr>
<tr>
<td>7</td>
<td> 数据部分的长度</td>
</tr>
<tr>
<td>00</td>
<td> 使用修改车辆属性的Action，其id为0</td>
</tr>
<tr>
<td>01</td>
<td> 01表示修改汽车</td>
</tr>
<tr>
<td>01</td>
<td> 表示希望改变每个车辆的一个属性</td>
</tr>
<tr>
<td>01</td>
<td> 表示希望改变一个车辆</td>
</tr>
<tr>
<td>00</td>
<td>第一个被修改的车辆ID为00，代表汽车“MPS Regal Bus”</td>
</tr>
<tr>
<td>08</td>
<td> 修改车辆的08属性，08属性代表车辆的速度</td>
</tr>
<tr>
<td>EF</td>
<td> 车辆的速度</td>
</tr>
</tbody>
</table>
&nbsp;</p>
